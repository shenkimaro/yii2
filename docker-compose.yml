networks:
  rede_app:    
    driver: bridge

services:
  app01: &app
    container_name: php-mysql
    build: 
      context: ./container/php/
    hostname: app01  
    networks:
      rede_app:
        aliases:
          - app01
    environment:
      - DB_HOSTNAME=db
      - PORT=9000
    volumes:
      - type: bind
        source: ./backend/app/
        target: /var/www/html/   
        
  db: &data_base
    image: mysql:8
    restart: always
    hostname: db
    networks:
      rede_app:
        aliases:
          - db
    environment:
      MYSQL_DATABASE: processo_seletivo
      MYSQL_ROOT_PASSWORD: teste
    ports:
      - 3308:3306  
    volumes:
      - type: bind
        source: ./container/mysql/my.cnf
        target: /etc/my.cnf
      - type: bind
        source: ./container/mysql/init.sql 
        target: /docker-entrypoint-initdb.d/init.sql   
        
  nginx:
    image: nginx
    restart: always
    networks:
      - rede_app
    ports:
      - 9999:80 
    depends_on:
      - app01
    volumes:
      - type: bind
        source: ./container/nginx/nginx.conf
        target: /etc/nginx/nginx.conf 
      - type: bind
        source: ./frontend/
        target: /var/www/html/ 
